<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Jogo War</title>
  <link href="{{ url_for('static', filename='index-styles.css') }}" rel="stylesheet" />
</head>
<body>
  <h1>Jogo War</h1>
  <h3>Versão RJ</h3>
  <button id="openDialog">Jogar</button>

  <audio id="audio" controls loop>
    <source src="{{ url_for('static', filename='metro_rio.mp3') }}" type="audio/mpeg">
  </audio>

  <dialog id="configDialog">
    <form action="/inicializar_partida" method="POST">
      <label for="duracao_turno">Duração do turno:</label>
      <select name="duracao_turno" id="duracao_turno">
        <option value="60">1 minuto</option>
        <option value="120">2 minutos</option>
        <option value="180" selected>3 minutos</option>
        <option value="240">4 minutos</option>
        <option value="300">5 minutos</option>
      </select>
      
      <label for="qtd_humanos">Quantidade de jogadores humanos:</label>
      <select name="qtd_humanos" id="qtd_humanos">
        <option value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3" selected>3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
      </select>
      
      <label for="qtd_ai">Quantidade de jogadores artificiais:</label>
      <select name="qtd_ai" id="qtd_ai">
        <option value="0" selected>0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
      </select>

      <p id="total-jogadores-aviso" style="color: red; display: none;">O total de jogadores deve ser entre 3 e 6.</p>
     
      <div class="dialog-actions">
        <button type="submit" name="acao" value="cancelar">Cancelar</button>
        <button type="submit" name="acao" value="iniciar">Iniciar</button>
      </div>
    </form>
  </dialog>

  <script>
    const dialog = document.getElementById('configDialog');
    const openBtn = document.getElementById('openDialog');
    const audio = document.getElementById("audio");

    const humanosSelect = document.getElementById('qtd_humanos');
    const aiSelect = document.getElementById('qtd_ai');
    const aviso = document.getElementById('total-jogadores-aviso');
    const iniciarBtn = document.getElementById('iniciar-btn');

    function validarTotalJogadores() {
      const total = parseInt(humanosSelect.value) + parseInt(aiSelect.value);
      
      if (total < 3 || total > 6) {
        aviso.classList.remove('aviso-hidden');
        iniciarBtn.disabled = true;
        iniciarBtn.classList.add('disabled');
      } else {
        aviso.classList.add('aviso-hidden');
        iniciarBtn.disabled = false;
        iniciarBtn.classList.remove('disabled');
      }
    }

    humanosSelect.addEventListener('change', validarTotalJogadores);
    aiSelect.addEventListener('change', validarTotalJogadores);

    openBtn.addEventListener('click', () => {
      dialog.showModal();
      validarTotalJogadores(); 
    });
  </script>
</body>
</html>